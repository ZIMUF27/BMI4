{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Admin/Documents/trae_projects/BMI4/src/app/dashboard/page.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect } from \"react\"\nimport { useSession, signOut } from \"next-auth/react\"\nimport Link from \"next/link\"\n\ninterface BMIRecord {\n  id: number\n  weight: number\n  height: number\n  bmi_value: number\n  record_date: string\n}\n\nexport default function Dashboard() {\n  const { data: session } = useSession()\n  const [weight, setWeight] = useState(\"\")\n  const [height, setHeight] = useState(\"\")\n  const [bmiResult, setBmiResult] = useState<number | null>(null)\n  const [history, setHistory] = useState<BMIRecord[]>([])\n\n  const fetchHistory = async () => {\n    const res = await fetch(\"/api/bmi\")\n    if (res.ok) {\n      const data = await res.json()\n      setHistory(data)\n    }\n  }\n\n  useEffect(() => {\n    fetchHistory()\n  }, [])\n\n  const calculateBMI = async (e: React.FormEvent) => {\n    e.preventDefault()\n    if (!weight || !height) return\n\n    // Optimistic calc\n    const h = parseFloat(height) / 100\n    const w = parseFloat(weight)\n    const bmi = parseFloat((w / (h * h)).toFixed(2))\n    setBmiResult(bmi)\n\n    // Save\n    const res = await fetch(\"/api/bmi\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify({ weight: w, height: parseFloat(height) }),\n    })\n\n    if (res.ok) {\n      fetchHistory()\n      setWeight(\"\")\n      setHeight(\"\")\n    }\n  }\n\n  const getBMIStatus = (bmi: number) => {\n    if (bmi < 18.5) return \"Underweight (ผอม)\"\n    if (bmi < 23) return \"Normal (ปกติ)\"\n    if (bmi < 25) return \"Overweight (ท้วม)\"\n    return \"Obese (อ้วน)\"\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-100 p-8\">\n      <div className=\"max-w-4xl mx-auto bg-white rounded shadow p-6\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <h1 className=\"text-3xl font-bold text-black\">BMI Dashboard</h1>\n          <div className=\"flex gap-4\">\n             <Link href=\"/reports\" className=\"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600\">\n                View Reports\n             </Link>\n             <button onClick={() => signOut()} className=\"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600\">\n                Logout\n             </button>\n          </div>\n        </div>\n        \n        <div className=\"mb-8\">\n            <h2 className=\"text-xl font-semibold mb-4 text-black\">Calculate BMI</h2>\n            <form onSubmit={calculateBMI} className=\"flex flex-col md:flex-row gap-4 md:items-end\">\n                <div className=\"w-full md:w-auto\">\n                    <label className=\"block text-sm text-gray-700\">Weight (kg)</label>\n                    <input \n                        type=\"number\" step=\"0.1\"\n                        value={weight} onChange={e => setWeight(e.target.value)}\n                        className=\"border p-2 rounded w-full md:w-32 text-black\"\n                        required\n                    />\n                </div>\n                <div className=\"w-full md:w-auto\">\n                    <label className=\"block text-sm text-gray-700\">Height (cm)</label>\n                    <input \n                        type=\"number\" step=\"0.1\"\n                        value={height} onChange={e => setHeight(e.target.value)}\n                        className=\"border p-2 rounded w-full md:w-32 text-black\"\n                        required\n                    />\n                </div>\n                <button type=\"submit\" className=\"w-full md:w-auto bg-blue-600 text-white px-6 py-2 rounded hover:bg-blue-700\">\n                    Calculate & Save\n                </button>\n            </form>\n            {bmiResult && (\n                <div className=\"mt-4 p-4 bg-blue-50 rounded\">\n                    <p className=\"text-lg font-medium text-black\">BMI: {bmiResult}</p>\n                    <p className=\"text-lg text-blue-800\">Status: {getBMIStatus(bmiResult)}</p>\n                </div>\n            )}\n        </div>\n\n        <div>\n            <h2 className=\"text-xl font-semibold mb-4 text-black\">History</h2>\n            <div className=\"overflow-x-auto\">\n                <table className=\"min-w-full divide-y divide-gray-200\">\n                    <thead className=\"bg-gray-50\">\n                        <tr>\n                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Date</th>\n                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Weight</th>\n                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">Height</th>\n                            <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">BMI</th>\n                        </tr>\n                    </thead>\n                    <tbody className=\"bg-white divide-y divide-gray-200\">\n                        {history.map((record) => (\n                            <tr key={record.id}>\n                                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                                    {new Date(record.record_date).toLocaleString()}\n                                </td>\n                                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{record.weight}</td>\n                                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{record.height}</td>\n                                <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">{record.bmi_value}</td>\n                            </tr>\n                        ))}\n                    </tbody>\n                </table>\n            </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAce,SAAS;IACtB,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,IAAA,4JAAU;IACpC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAC;IACrC,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,iNAAQ,EAAC;IACrC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAgB;IAC1D,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAc,EAAE;IAEtD,MAAM,eAAe;QACnB,MAAM,MAAM,MAAM,MAAM;QACxB,IAAI,IAAI,EAAE,EAAE;YACV,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,WAAW;QACb;IACF;IAEA,IAAA,kNAAS,EAAC;QACR;IACF,GAAG,EAAE;IAEL,MAAM,eAAe,OAAO;QAC1B,EAAE,cAAc;QAChB,IAAI,CAAC,UAAU,CAAC,QAAQ;QAExB,kBAAkB;QAClB,MAAM,IAAI,WAAW,UAAU;QAC/B,MAAM,IAAI,WAAW;QACrB,MAAM,MAAM,WAAW,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,EAAE,OAAO,CAAC;QAC7C,aAAa;QAEb,OAAO;QACP,MAAM,MAAM,MAAM,MAAM,YAAY;YAClC,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE,QAAQ;gBAAG,QAAQ,WAAW;YAAQ;QAC/D;QAEA,IAAI,IAAI,EAAE,EAAE;YACV;YACA,UAAU;YACV,UAAU;QACZ;IACF;IAEA,MAAM,eAAe,CAAC;QACpB,IAAI,MAAM,MAAM,OAAO;QACvB,IAAI,MAAM,IAAI,OAAO;QACrB,IAAI,MAAM,IAAI,OAAO;QACrB,OAAO;IACT;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAG,WAAU;sCAAgC;;;;;;sCAC9C,8OAAC;4BAAI,WAAU;;8CACZ,8OAAC,uKAAI;oCAAC,MAAK;oCAAW,WAAU;8CAA+D;;;;;;8CAG/F,8OAAC;oCAAO,SAAS,IAAM,IAAA,yJAAO;oCAAI,WAAU;8CAA2D;;;;;;;;;;;;;;;;;;8BAM5G,8OAAC;oBAAI,WAAU;;sCACX,8OAAC;4BAAG,WAAU;sCAAwC;;;;;;sCACtD,8OAAC;4BAAK,UAAU;4BAAc,WAAU;;8CACpC,8OAAC;oCAAI,WAAU;;sDACX,8OAAC;4CAAM,WAAU;sDAA8B;;;;;;sDAC/C,8OAAC;4CACG,MAAK;4CAAS,MAAK;4CACnB,OAAO;4CAAQ,UAAU,CAAA,IAAK,UAAU,EAAE,MAAM,CAAC,KAAK;4CACtD,WAAU;4CACV,QAAQ;;;;;;;;;;;;8CAGhB,8OAAC;oCAAI,WAAU;;sDACX,8OAAC;4CAAM,WAAU;sDAA8B;;;;;;sDAC/C,8OAAC;4CACG,MAAK;4CAAS,MAAK;4CACnB,OAAO;4CAAQ,UAAU,CAAA,IAAK,UAAU,EAAE,MAAM,CAAC,KAAK;4CACtD,WAAU;4CACV,QAAQ;;;;;;;;;;;;8CAGhB,8OAAC;oCAAO,MAAK;oCAAS,WAAU;8CAA8E;;;;;;;;;;;;wBAIjH,2BACG,8OAAC;4BAAI,WAAU;;8CACX,8OAAC;oCAAE,WAAU;;wCAAiC;wCAAM;;;;;;;8CACpD,8OAAC;oCAAE,WAAU;;wCAAwB;wCAAS,aAAa;;;;;;;;;;;;;;;;;;;8BAKvE,8OAAC;;sCACG,8OAAC;4BAAG,WAAU;sCAAwC;;;;;;sCACtD,8OAAC;4BAAI,WAAU;sCACX,cAAA,8OAAC;gCAAM,WAAU;;kDACb,8OAAC;wCAAM,WAAU;kDACb,cAAA,8OAAC;;8DACG,8OAAC;oDAAG,WAAU;8DAAiF;;;;;;8DAC/F,8OAAC;oDAAG,WAAU;8DAAiF;;;;;;8DAC/F,8OAAC;oDAAG,WAAU;8DAAiF;;;;;;8DAC/F,8OAAC;oDAAG,WAAU;8DAAiF;;;;;;;;;;;;;;;;;kDAGvG,8OAAC;wCAAM,WAAU;kDACZ,QAAQ,GAAG,CAAC,CAAC,uBACV,8OAAC;;kEACG,8OAAC;wDAAG,WAAU;kEACT,IAAI,KAAK,OAAO,WAAW,EAAE,cAAc;;;;;;kEAEhD,8OAAC;wDAAG,WAAU;kEAAqD,OAAO,MAAM;;;;;;kEAChF,8OAAC;wDAAG,WAAU;kEAAqD,OAAO,MAAM;;;;;;kEAChF,8OAAC;wDAAG,WAAU;kEAAqD,OAAO,SAAS;;;;;;;+CAN9E,OAAO,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgB9C"}}]
}